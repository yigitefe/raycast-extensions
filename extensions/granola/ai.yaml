instructions: |
    - Use `list-meetings` to get note IDs before any content or transcript request.
    - For any request that needs content (summaries, tasks, original/enhanced notes, TL;DR), you MUST call `get-note-content` after `list-meetings`. Do not answer using only metadata.
    - For transcript requests, you MUST call `get-transcript` after `list-meetings`. Do not answer without the transcript tool output.
    - For "latest"/"most recent", call `list-meetings` with `{ "date": "latest", "limit": 1 }` (or higher if the user asks for multiple).
    - Use `title` in `list-meetings` for topical queries.
    - Use `get-note-content` for note content; set `contentType` to `"original"` or `"enhanced"` only when requested.
    - Use `get-transcript` only for transcript requests.
    - Use `list-folders` only for folder questions or to get a folder ID.
    - If the user explicitly mentions a folder (for example, includes the word "folder" or asks for a folder by name), call `list-folders` first, then use the matching folder ID with `list-meetings`.
    - If the user asks for available recipes or to search recipes, call `recipes` with action `"list"` or `"search"` and the query.
    - Any `/slug` token (for example `/tldr`) is a recipe; call `recipes` first with that slug and do not treat it as a title.
    - Use `save-to-notion` only after you have the note IDs, pass them as `noteIds`, and preserve the order returned by `list-meetings`.

evals:
    - input: "@granola Please summarize my last note"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "sample-id-123"
            title: "Summary"
            date: "2025-03-06T16:15:20.057Z"
        get-note-content:
          title: "Summary"
          date: "2025-03-06T16:15:20.057Z"
          content: "### Meeting Context\n\n*   Testing session for Granola application's transcription capabilities\n*   Two participants simulating back-and-forth conversation..."
          folderIds: []
          folderNames: []
      expected:
        - callsTool:
            name: "list-meetings"
            arguments:
              date: "latest"
              limit: 1
        - callsTool:
            name: "get-note-content"
            arguments:
              noteId: "sample-id-123"

    - input: "@granola Show me the transcript of my last meeting about the product launch"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "sample-id-456"
            title: "Product Launch"
            date: "2025-03-06T16:15:20.057Z"
        get-transcript:
          transcript: "John: Let's discuss the product launch timeline.\nSarah: I think we should aim for next quarter.\nJohn: That makes sense, we still need to finalize the marketing materials."
          title: "Product Launch"
          date: "2025-03-06T16:15:20.057Z"
      expected:
        - callsTool:
            name: "list-meetings"
            arguments:
              title: "product launch"
              limit: 1
        - callsTool:
            name: "get-transcript"
            arguments:
              noteId: "sample-id-456"

    - input: "@granola summarize the transcript of my latest note"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "sample-id-789"
            title: "Team Sync"
            date: "2025-04-10T14:30:00.000Z"
        get-transcript:
          transcript: "**Me:** Let's review our progress for this sprint.\n\n**Sarah:** We've completed the new dashboard feature.\n\n**John:** QA found two minor bugs we need to fix before release."
          title: "Team Sync"
          date: "2025-04-10T14:30:00.000Z"
      expected:
        - callsTool:
            name: "list-meetings"
            arguments:
              date: "latest"
              limit: 1
        - callsTool:
            name: "get-transcript"
            arguments:
              noteId: "sample-id-789"

    - input: "@granola what folders do I have"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
      expected:
        - callsTool:
            name: "list-folders"
            arguments: {}

    - input: "@granola save my last 3 meeting notes to Notion"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "note-1"
            title: "Team Sync"
            date: "2025-03-15T14:00:00.000Z"
          - id: "note-2"
            title: "Client Call"
            date: "2025-03-14T16:30:00.000Z"
          - id: "note-3"
            title: "Planning Session"
            date: "2025-03-13T11:00:00.000Z"
        save-to-notion:
          results:
            - noteId: "note-1"
              title: "Team Sync"
              status: "success"
              pageUrl: "https://www.notion.so/team-sync-123"
            - noteId: "note-2"
              title: "Client Call"
              status: "success"
              pageUrl: "https://www.notion.so/client-call-456"
            - noteId: "note-3"
              title: "Planning Session"
              status: "success"
              pageUrl: "https://www.notion.so/planning-789"
      expected:
        - callsTool:
            name: "list-meetings"
            arguments:
              date: "latest"
              limit: 3
        - callsTool:
            name: "save-to-notion"

    - input: "@granola list my most recent meeting"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "latest-meeting-123"
            title: "Engineering Sync"
            date: "2025-03-16T10:00:00.000Z"
      expected:
        - callsTool:
            name: "list-meetings"
            arguments:
              date: "latest"
              limit: 1

    - input: "@granola show me my original notes from yesterday"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "original-notes-123"
            title: "User Notes"
            date: "2025-03-15T14:00:00.000Z"
        get-note-content:
          title: "User Notes"
          date: "2025-03-15T14:00:00.000Z"
          content: "Raw user-written content about the meeting"
          folderIds: []
          folderNames: []
      expected:
        - callsTool:
            name: "list-meetings"
            arguments:
              date: "yesterday"
        - callsTool:
            name: "get-note-content"
            arguments:
              noteId: "original-notes-123"
              contentType: "original"

    - input: "@granola get the enhanced AI notes for my project meetings"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "enhanced-notes-456"
            title: "Project Meeting"
            date: "2025-03-16T09:00:00.000Z"
        get-note-content:
          title: "Project Meeting"
          date: "2025-03-16T09:00:00.000Z"
          content: "AI-enhanced structured notes with key insights"
          folderIds: []
          folderNames: []
      expected:
        - or:
            - callsTool:
                name: "list-meetings"
                arguments:
                  title: "project"
            - callsTool:
                name: "list-meetings"
                arguments:
                  folderId: "folder-123"
        - callsTool:
            name: "get-note-content"
            arguments:
              noteId: "enhanced-notes-456"
              contentType: "enhanced"

    - input: "@granola what are the tasks from my latest meeting?"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "latest-meeting-123"
            title: "Product Launch Planning"
            date: "2025-03-16T14:00:00.000Z"
            folderIds: ["work-folder-456"]
            folderNames: ["Work Projects"]
        get-note-content:
          title: "Product Launch Planning"
          date: "2025-03-16T14:00:00.000Z"
          content: "### Product Launch Tasks\n\n- Finalize marketing materials by Friday\n- Schedule demo with engineering team\n- Prepare presentation for stakeholders\n- Review budget allocation for Q2"
          folderIds: ["work-folder-456"]
          folderNames: ["Work Projects"]
      expected:
        - callsTool:
            name: "list-meetings"
            arguments:
              date: "latest"
              limit: 1
        - callsTool:
            name: "get-note-content"
            arguments:
              noteId: "latest-meeting-123"

    - input: "@granola /tldr my latest meeting"
      mocks:
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        recipes:
          - slug: "tldr"
            id: "r-101"
            config:
              instructions: "Provide a concise TL;DR"
        list-meetings:
          - id: "latest-meeting-123"
            title: "Engineering Sync"
            date: "2025-03-16T10:00:00.000Z"
        get-note-content:
          title: "Engineering Sync"
          date: "2025-03-16T10:00:00.000Z"
          content: "Product roadmap discussion with engineering team"
          folderIds: []
          folderNames: []
      expected:
        - callsTool:
            name: "recipes"
            arguments:
              action: "get"
              slug: "tldr"
        - callsTool:
            name: "list-meetings"
            arguments:
              date: "latest"
              limit: 1
        - callsTool:
            name: "get-note-content"
            arguments:
              noteId: "latest-meeting-123"

    - input: "@granola show me meetings in my Work Projects folder"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
        list-meetings:
          - id: "note-1"
            title: "Roadmap Review"
            date: "2025-03-11T10:00:00.000Z"
          - id: "note-2"
            title: "Sprint Planning"
            date: "2025-03-10T09:00:00.000Z"
      expected:
        - callsTool:
            name: "list-folders"
            arguments: {}
        - callsTool:
            name: "list-meetings"
            arguments:
              folderId: "folder-123"

    - input: "@granola what recipes are available?"
      mocks:
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
            - slug: "action-items"
              defaultConfig:
                instructions: "Extract action items"
          sharedRecipes: []
          unlistedRecipes: []
      expected:
        - callsTool:
            name: "recipes"
            arguments:
              action: "list"

    - input: "@granola list my meetings from last week about hiring"
      mocks:
        recipes:
          featureEnabled: true
          userRecipes: []
          defaultRecipes:
            - slug: "tldr"
              defaultConfig:
                instructions: "Provide a concise TL;DR"
          sharedRecipes: []
          unlistedRecipes: []
        list-folders:
          - id: "folder-123"
            name: "Work Projects"
            description: "Notes related to ongoing work projects"
            noteCount: 15
            createdAt: "2025-03-06T16:15:20.057Z"
            noteIds: ["note-1", "note-2"]
          - id: "folder-456"
            name: "Personal"
            noteCount: 8
            createdAt: "2025-03-10T14:30:00.000Z"
            noteIds: ["note-3", "note-4"]
        list-meetings:
          - id: "note-55"
            title: "Hiring Sync"
            date: "2025-03-05T13:00:00.000Z"
          - id: "note-56"
            title: "Recruiting Pipeline"
            date: "2025-03-03T09:30:00.000Z"
      expected:
        - callsTool:
            name: "list-meetings"
            arguments:
              title: "hiring"
              date: "last week"
